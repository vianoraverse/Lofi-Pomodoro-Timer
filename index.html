<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lo-Fi Pomodoro Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        * {
            font-family: 'Inter', sans-serif;
        }
        .progress-ring__circle {
            transition: stroke-dashoffset 0.3s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .sound-btn.active {
            background-color: #7c3aed; /* Tailwind bg-purple-600 */
            box-shadow: 0 0 0 2px #c4b5fd; /* Tailwind ring-2 ring-purple-400 */
        }
        .volume-slider {
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 5px;
            background: #4B5563;
            outline: none;
        }
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #A78BFA;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-purple-500 mb-2">Lo-Fi Pomodoro</h1>
            <p class="text-gray-400">Focus with ambient sounds & chill beats</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Timer Section -->
            <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold">Timer</h2>
                    <div class="flex space-x-2">
                        <button id="work-btn" class="px-4 py-1 rounded-full bg-purple-600 text-white">Work</button>
                        <button id="break-btn" class="px-4 py-1 rounded-full bg-gray-700 text-gray-300">Break</button>
                    </div>
                </div>

                <div class="flex justify-center my-8">
                    <div class="relative">
                        <svg class="w-64 h-64">
                            <circle 
                                class="text-gray-700" 
                                stroke-width="10" 
                                stroke="currentColor" 
                                fill="transparent" 
                                r="120" 
                                cx="128" 
                                cy="128"
                            />
                            <circle 
                                id="progress-ring" 
                                class="progress-ring__circle text-purple-500" 
                                stroke-width="10" 
                                stroke-dasharray="754" 
                                stroke-dashoffset="0" 
                                stroke-linecap="round" 
                                stroke="currentColor" 
                                fill="transparent" 
                                r="120" 
                                cx="128" 
                                cy="128"
                            />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center flex-col">
                            <div id="time-display" class="text-5xl font-bold mb-2">25:00</div>
                            <button id="timer-control" class="px-6 py-2 bg-purple-600 rounded-full text-white font-medium hover:bg-purple-700 transition">Start</button>
                        </div>
                    </div>
                </div>

                <div class="settings mt-6">
                    <h3 class="text-lg font-medium mb-3">Timer Settings</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Work (minutes)</label>
                            <input type="number" id="work-time" min="1" max="60" value="25" class="w-full bg-gray-700 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Break (minutes)</label>
                            <input type="number" id="break-time" min="1" max="30" value="5" class="w-full bg-gray-700 rounded-md px-3 py-2">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Music & Sound Section -->
            <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
                <!-- Music Player -->
                <div class="mb-8">
                    <h2 class="text-2xl font-semibold mb-4">Lo-Fi Player</h2>
                    <div class="bg-gray-700 rounded-lg p-4">
                        <div class="flex items-center mb-4">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/705b4b9e-d849-4a10-85a7-1723b4b0427e.png" alt="Lo-fi beat cover art with anime character studying at night" class="rounded-lg w-16 h-16 mr-4">
                            <div>
                                <h3 id="current-track" class="font-medium">Track 1</h3>
                                <p class="text-sm text-gray-400">Lo-fi Artist</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between mt-3">
                            <audio id="music-player" autoplay></audio>
                            <button id="prev-track" class="p-2 text-gray-300 hover:text-white">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                </svg>
                            </button>
                            <button id="play-pause" class="p-2 bg-purple-600 rounded-full text-white hover:bg-purple-700">
                                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </button>
                            <button id="next-track" class="p-2 text-gray-300 hover:text-white">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                </svg>
                            </button>
                            </div>
                        <div class="mt-3">
                            <div class="flex justify-between text-xs text-gray-400 mb-1">
                                <span id="current-time">0:00</span>
                                <span id="duration">0:00</span>
                            </div>
                            <input type="range" min="0" max="100" value="0" class="w-full volume-slider" id="progress-slider">
                        </div>
                    </div>
                </div>

                <!-- Soundboard -->
                <div>
                    <h2 class="text-2xl font-semibold mb-4">Ambient Sounds</h2>
                    <div class="grid grid-cols-2 gap-3">
                        <button class="sound-btn bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition flex items-center" data-sound="rain">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/2330a045-af0b-4cd8-ae25-6e20e3f944b1.png" alt="Rain falling on window with water droplets" class="w-8 h-8 mr-2 rounded">
                            <span>Rain</span>
                        </button>
                        <button class="sound-btn bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition flex items-center" data-sound="river">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/d67c4584-bdb6-4601-b2ca-8bc704995f01.png" alt="Peaceful river flow through forest with mossy rocks" class="w-8 h-8 mr-2 rounded">
                            <span>River</span>
                        </button>
                        <button class="sound-btn bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition flex items-center" data-sound="keyboard">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/23ea8c32-3f3c-4d1f-bd0f-e7d79c1d338e.png" alt="Mechanical keyboard with backlight typing in slow motion" class="w-8 h-8 mr-2 rounded">
                            <span>Keyboard</span>
                        </button>
                        <button class="sound-btn bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition flex items-center" data-sound="coffee">
                            <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/67f93924-fc9e-4230-b44a-1e4fa4d17474.png" alt="Coffee shop with espresso machine and people chatting quietly" class="w-8 h-8 mr-2 rounded">
                            <span>Coffee Shop</span>
                        </button>
                    </div>
                    
                    <div class="mt-4">
                        <label class="text-sm text-gray-400">Volume: <span id="volume-value">50</span>%</label>
                        <input type="range" min="0" max="100" value="50" class="volume-slider w-full" id="volume-slider">
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-8 text-center text-gray-400">
            <h3 class="text-lg font-medium mb-2">Happy Studying! :3</h3>
            <p class="text-sm mb-4">by: vxnova n' friends</p>
            <div class="flex justify-center space-x-4">
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const timeDisplay = document.getElementById('time-display');
        const timerControl = document.getElementById('timer-control');
        const workBtn = document.getElementById('work-btn');
        const breakBtn = document.getElementById('break-btn');
        const workTimeInput = document.getElementById('work-time');
        const breakTimeInput = document.getElementById('break-time');
        const progressRing = document.getElementById('progress-ring');
        const musicPlayer = document.getElementById('music-player');
        const playPauseBtn = document.getElementById('play-pause');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const prevTrackBtn = document.getElementById('prev-track');
        const nextTrackBtn = document.getElementById('next-track');
        const currentTrack = document.getElementById('current-track');
        const soundBtns = document.querySelectorAll('.sound-btn');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeValue = document.getElementById('volume-value');

        // Variables
        let workTime = 25 * 60;
        let breakTime = 5 * 60;
        let timeLeft = workTime;
        let isRunning = false;
        let isWorkTime = true;
        let timerInterval;
        let circleCircumference = 2 * Math.PI * 120;
        let progressPercentage = 0;
        let currentTrackIndex = 0;
        let isTrackChanging = false;

        // Default tracks - replace these with your own music files
        const tracks = [
            { name: 'Bedtime After A Coffee - ikkunn (Barradeen)', file: './lofi/track1.mp3' },
            { name: 'Colorful Flowers - Tokyo Music Walker', file: './lofi/track2.mp3' },
            { name: 'Daydreams - Purrple Cat', file: './lofi/track3.mp3' },
            { name: 'Double Rainbow - Purrple Cat', file: './lofi/track4.mp3' },
            { name: 'Echoes In Blue - Tokyo Music Walker', file: './lofi/track5.mp3' },
            { name: 'Downtown Glow - Ghostrifter Official', file: './lofi/track6.mp3' },
            { name: 'Purple Dream - Ghostrifter Official', file: './lofi/track7.mp3' },
            { name: 'Little Wishes - Tokyo Music Walker', file: './lofi/track8.mp3' },
            { name: 'Magical Moments - Purrple Cat', file: './lofi/track9.mp3' },
            { name: 'Memories Of Spring - Tokyo Music Walker', file: './lofi/track10.mp3' },
            { name: 'Missing You - Purrple Cat', file: './lofi/track11.mp3' },
            { name: 'Morning Routine - Ghostrifter Official', file: './lofi/track12.mp3' },
            { name: 'New Beginnings - Tokyo Music Walker', file: './lofi/track13.mp3' },
            { name: 'Sonder - Purrple Cat', file: './lofi/track14.mp3' },
            { name: 'Storm Clouds - Purrple Cat', file: './lofi/track15.mp3' },
            { name: 'Brunch For Two - Tokyo Music Walker', file: './lofi/track16.mp3' },
            { name: 'Day Off - Tokyo Music Walker', file: './lofi/track17.mp3' },
            { name: 'Transcendence - Alexander Nakarada', file: './lofi/track18.mp3' },
            { name: 'When I Was A Boy - Tokyo Music Walker', file: './lofi/track19.mp3' },
            { name: 'Wildflowers - Purrple Cat', file: './lofi/track20.mp3' }
        ];

        // Sound effects - replace these with your own files
        const sounds = {
            rain: { file: "./audio/rain.mp3", audio: new Audio() },
            river: { file: "./audio/river.mp3", audio: new Audio() },
            keyboard: { file: "./audio/keyboard.mp3", audio: new Audio() },
            coffee: { file: "./audio/coffee.mp3", audio: new Audio() }
        };

        // Initialize
        updateTimeDisplay();
        updateProgressCircle();
        loadTrack(currentTrackIndex);

        // Timer functions
        function startTimer() {
            if (!isRunning) {
                isRunning = true;
                timerControl.textContent = 'Pause';
                timerInterval = setInterval(updateTimer, 1000);
            } else {
                pauseTimer();
            }
        }

        function pauseTimer() {
            isRunning = false;
            timerControl.textContent = 'Resume';
            clearInterval(timerInterval);
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            timeLeft = isWorkTime ? workTime : breakTime;
            updateTimeDisplay();
            updateProgressCircle();
            timerControl.textContent = 'Start';
        }

        function updateTimer() {
            timeLeft--;
            updateTimeDisplay();
            updateProgressCircle();

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                timerControl.textContent = 'Start';
                isRunning = false;
                isWorkTime = !isWorkTime;
                timeLeft = isWorkTime ? workTime : breakTime;
                updateModeButtons();
                playNotificationSound();
                setTimeout(() => { 
                    if (confirm(`${isWorkTime ? 'Break ended!' : 'Work session ended!'} Start ${isWorkTime ? 'work' : 'break'}?`)) {
                        startTimer();
                    }
                }, 100);
            }
        }

        function playNotificationSound() {
            const sound = new Audio('./audio/notification.mp3');
            sound.volume = volumeSlider.value / 100;
            sound.play();
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function updateTimeDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timeDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        function updateProgressCircle() {
            const maxTime = isWorkTime ? workTime : breakTime;
            progressPercentage = ((maxTime - timeLeft) / maxTime) * circleCircumference;
            progressRing.style.strokeDashoffset = circleCircumference - progressPercentage;
        }

        function updateModeButtons() {
            if (isWorkTime) {
                workBtn.classList.add('bg-purple-600', 'text-white');
                workBtn.classList.remove('bg-gray-700', 'text-gray-300');
                breakBtn.classList.remove('bg-purple-600', 'text-white');
                breakBtn.classList.add('bg-gray-700', 'text-gray-300');
            } else {
                workBtn.classList.remove('bg-purple-600', 'text-white');
                workBtn.classList.add('bg-gray-700', 'text-gray-300');
                breakBtn.classList.add('bg-purple-600', 'text-white');
                breakBtn.classList.remove('bg-gray-700', 'text-gray-300');
            }
        }

        // Music player functions
        function loadTrack(index) {
            currentTrackIndex = index;
            currentTrack.textContent = tracks[index].name;
            musicPlayer.src = tracks[index].file;
            musicPlayer.load();

            musicPlayer.addEventListener('loadedmetadata', function() {
            document.getElementById('duration').textContent = formatTime(musicPlayer.duration);
            isTrackChanging = false;
            if (!musicPlayer.paused) {
                musicPlayer.play();
            }
            });
        }

        function playPauseMusic() {
            if (musicPlayer.paused) {
                musicPlayer.play();
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
            } else {
                musicPlayer.pause();
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
            }
        }

        function prevTrack() {
            currentTrackIndex--;
            if (currentTrackIndex < 0) {
                currentTrackIndex = tracks.length - 1;
            }
            loadTrack(currentTrackIndex);
            if (!musicPlayer.paused) {
                musicPlayer.play();
            }
        }

        function nextTrack() {
            currentTrackIndex++;
            if (currentTrackIndex >= tracks.length) {
                currentTrackIndex = 0;
            }
            loadTrack(currentTrackIndex);
            if (!musicPlayer.paused) {
                musicPlayer.play();
            }
        }

        // Soundboard functions
        function toggleSound(soundType) {
            const sound = sounds[soundType];
            if (sound.audio.paused) {
                sound.audio.src = sound.file;
                sound.audio.loop = true;
                sound.audio.volume = volumeSlider.value / 100;
                sound.audio.play();
                document.querySelector(`[data-sound="${soundType}"]`).classList.add('active');
            } else {
                sound.audio.pause();
                document.querySelector(`[data-sound="${soundType}"]`).classList.remove('active');
            }
        }

        // Event listeners
        timerControl.addEventListener('click', startTimer);
        
        workTimeInput.addEventListener('change', () => {
            workTime = workTimeInput.value * 60;
            if (isWorkTime && !isRunning) {
                timeLeft = workTime;
                updateTimeDisplay();
                updateProgressCircle();
            }
        });

        breakTimeInput.addEventListener('change', () => {
            breakTime = breakTimeInput.value * 60;
            if (!isWorkTime && !isRunning) {
                timeLeft = breakTime;
                updateTimeDisplay();
                updateProgressCircle();
            }
        });

        workBtn.addEventListener('click', () => {
            if (!isWorkTime) {
                isWorkTime = true;
                timeLeft = workTime;
                updateTimeDisplay();
                updateProgressCircle();
                updateModeButtons();
                if (isRunning) {
                    resetTimer();
                    startTimer();
                }
            }
        });

        breakBtn.addEventListener('click', () => {
            if (isWorkTime) {
                isWorkTime = false;
                timeLeft = breakTime;
                updateTimeDisplay();
                updateProgressCircle();
                updateModeButtons();
                if (isRunning) {
                    resetTimer();
                    startTimer();
                }
            }
        });

        playPauseBtn.addEventListener('click', playPauseMusic);
        prevTrackBtn.addEventListener('click', prevTrack);
        nextTrackBtn.addEventListener('click', nextTrack);

        soundBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                toggleSound(btn.dataset.sound);
            });
        });

        volumeSlider.addEventListener('input', () => {
            const volume = volumeSlider.value;
            volumeValue.textContent = volume;
            musicPlayer.volume = volume / 100;
             musicPlayer.addEventListener('ended', nextTrack);
        musicPlayer.addEventListener('timeupdate', updateProgress);
        
        function updateProgress() {
            if (!isTrackChanging && !isNaN(musicPlayer.duration)) {
                const progress = (musicPlayer.currentTime / musicPlayer.duration) * 100;
                document.getElementById('progress-slider').value = progress;
                document.getElementById('current-time').textContent = formatTime(musicPlayer.currentTime);
            }
        }

        // Auto play next track when current ends
        musicPlayer.addEventListener('ended', function() {
            if (!musicPlayer.paused) {
                nextTrack();
            }
        });
        
        // Update progress while playing
        musicPlayer.addEventListener('timeupdate', function() {
            if (!musicPlayer.paused) {
                updateProgress();
            }
        });

        document.getElementById('progress-slider').addEventListener('input', function() {
            if (musicPlayer.duration && !isNaN(musicPlayer.duration)) {
                const seekTime = (this.value / 100) * musicPlayer.duration;
                musicPlayer.currentTime = seekTime;
                // Update time display immediately when seeking
                document.getElementById('current-time').textContent = formatTime(musicPlayer.currentTime);
            }
        });
            
            // Update volume for all playing sounds
            Object.values(sounds).forEach(sound => {
                if (!sound.audio.paused) {
                    sound.audio.volume = volume / 100;
                }
            });
        });
    </script>
</body>
</html>